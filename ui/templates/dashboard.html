{% extends "base.html" %}

{% block title %}Dashboard - Digital Twin System{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="/static/css/dashboard.css">
{% endblock %}

{% block content %}
<!-- Section 1: Twin Overview -->
<section class="twin-overview mb-6">
    <div class="card">
        <div class="card-body">
            <div class="flex items-center justify-between mb-4">
                <div class="flex items-center gap-4">
                    <div class="twin-avatar">
                        <i class="lni lni-robot"></i>
                    </div>
                    <div>
                        <h2 class="twin-name">Loading...</h2>
                        <p class="last-updated text-muted">Last updated: Loading...</p>
                        <div class="flex items-center gap-2">
                            <div class="status-dot"></div>
                            <span class="status-text">Active</span>
                        </div>
                    </div>
                </div>
                <button class="btn btn-primary btn-edit" data-twin-id="">Edit Twin</button>
            </div>
        </div>
    </div>
</section>

<!-- Section 2: Key Metrics -->
<section class="key-metrics mb-6">
    <h3 class="section-title">Key Metrics</h3>
    <div class="grid grid-cols-4 gap-4">
        <div class="metric-card card" data-metric="simulationAccuracy">
            <div class="card-body">
                <div class="metric-icon">
                    <i class="lni lni-target"></i>
                </div>
                <div class="metric-content">
                    <h4 class="metric-label">Simulation Accuracy</h4>
                    <div class="metric-value">94.2%</div>
                </div>
            </div>
        </div>
        
        <div class="metric-card card" data-metric="dataSourcesConnected">
            <div class="card-body">
                <div class="metric-icon">
                    <i class="lni lni-database"></i>
                </div>
                <div class="metric-content">
                    <h4 class="metric-label">Data Sources</h4>
                    <div class="metric-value">8 Connected</div>
                </div>
            </div>
        </div>
        
        <div class="metric-card card" data-metric="lastSync">
            <div class="card-body">
                <div class="metric-icon">
                    <i class="lni lni-sync"></i>
                </div>
                <div class="metric-content">
                    <h4 class="metric-label">Last Sync</h4>
                    <div class="metric-value">Just now</div>
                </div>
            </div>
        </div>
        
        <div class="metric-card card" data-metric="customMetric">
            <div class="card-body">
                <div class="metric-icon">
                    <i class="lni lni-stats-up"></i>
                </div>
                <div class="metric-content">
                    <h4 class="metric-label">System Status</h4>
                    <div class="metric-value">Optimal</div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Section 3: Interaction Log -->
<section class="interaction-log-section mb-6">
    <div class="flex items-center justify-between mb-4">
        <h3 class="section-title">Recent Interactions</h3>
        <button class="btn btn-secondary" onclick="loadDashboardData()">Refresh</button>
    </div>
    
    <div class="card">
        <div class="card-body">
            <div class="interaction-log">
                <!-- Interactions will be loaded dynamically -->
                <div class="text-center text-muted py-8">
                    <i class="lni lni-comments lni-3x mb-2"></i>
                    <p>Loading interactions...</p>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Section 4: Quick Actions -->
<section class="quick-actions mb-6">
    <h3 class="section-title">Quick Actions</h3>
    <div class="flex gap-4">
        <button class="btn btn-primary btn-create" onclick="showCreateTwinModal()">
            <i class="lni lni-plus mr-2"></i>
            Create New Twin
        </button>
        <button class="btn btn-secondary" onclick="loadDashboardData()">
            <i class="lni lni-reload mr-2"></i>
            Refresh Data
        </button>
        <button class="btn btn-outline" onclick="window.location.href='/ui/twins'">
            <i class="lni lni-list mr-2"></i>
            View All Twins
        </button>
    </div>
</section>

<!-- Create Twin Modal -->
<div id="create-twin-modal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3>Create New Digital Twin</h3>
            <button class="modal-close" onclick="closeModal('create-twin-modal')">&times;</button>
        </div>
        <form id="create-twin-form" class="modal-body">
            <div class="form-group">
                <label for="twin-name">Twin Name</label>
                <input type="text" id="twin-name" name="name" required class="form-input" placeholder="Enter twin name">
            </div>
            <div class="form-group">
                <label for="twin-description">Description</label>
                <textarea id="twin-description" name="description" class="form-input" rows="3" placeholder="Enter twin description"></textarea>
            </div>
            <div class="modal-actions">
                <button type="button" class="btn btn-secondary" onclick="closeModal('create-twin-modal')">Cancel</button>
                <button type="submit" class="btn btn-primary">Create Twin</button>
            </div>
        </form>
    </div>
</div>

<!-- Edit Twin Modal -->
<div id="edit-twin-modal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3>Edit Digital Twin</h3>
            <button class="modal-close" onclick="closeModal('edit-twin-modal')">&times;</button>
        </div>
        <form id="edit-twin-form" class="modal-body">
            <div class="form-group">
                <label for="edit-twin-name">Twin Name</label>
                <input type="text" id="edit-twin-name" name="name" required class="form-input" placeholder="Enter twin name">
            </div>
            <div class="form-group">
                <label for="edit-twin-description">Description</label>
                <textarea id="edit-twin-description" name="description" class="form-input" rows="3" placeholder="Enter twin description"></textarea>
            </div>
            <div class="modal-actions">
                <button type="button" class="btn btn-secondary" onclick="closeModal('edit-twin-modal')">Cancel</button>
                <button type="submit" class="btn btn-primary">Update Twin</button>
            </div>
        </form>
    </div>
</div>
{% endblock %}
